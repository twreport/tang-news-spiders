2022-08-17 12:00:18 [scrapy.utils.log] INFO: Scrapy 2.5.1 started (bot: sinatop)
2022-08-17 12:00:18 [scrapy.utils.log] INFO: Versions: lxml 4.7.1.0, libxml2 2.9.12, cssselect 1.1.0, parsel 1.6.0, w3lib 1.22.0, Twisted 21.7.0, Python 3.8.12 | packaged by conda-forge | (default, Oct 12 2021, 23:40:23) - [GCC 9.4.0], pyOpenSSL 21.0.0 (OpenSSL 1.1.1m  14 Dec 2021), cryptography 36.0.1, Platform Linux-5.4.0-1060-raspi-aarch64-with-glibc2.17
2022-08-17 12:00:18 [scrapy.utils.log] DEBUG: Using reactor: twisted.internet.epollreactor.EPollReactor
2022-08-17 12:00:18 [scrapy.crawler] INFO: Overridden settings:
{'BOT_NAME': 'sinatop',
 'DOWNLOAD_DELAY': 5,
 'FEED_EXPORT_ENCODING': 'utf-8',
 'LOG_FILE': 'logs/sinatop/sina/1081d4391de111edad69ed3bac0f783f.log',
 'NEWSPIDER_MODULE': 'sinatop.spiders',
 'SPIDER_MODULES': ['sinatop.spiders']}
2022-08-17 12:00:19 [scrapy.extensions.telnet] INFO: Telnet Password: 01a0a8f53ba0d687
2022-08-17 12:00:19 [scrapy.middleware] INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats',
 'scrapy.extensions.telnet.TelnetConsole',
 'scrapy.extensions.memusage.MemoryUsage',
 'scrapy.extensions.logstats.LogStats']
2022-08-17 12:00:19 [root] WARNING: =================== Sina Hot ====================
2022-08-17 12:00:20 [scrapy.middleware] INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.cookies.CookiesMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats']
2022-08-17 12:00:20 [scrapy.middleware] INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
2022-08-17 12:00:20 [scrapy.middleware] INFO: Enabled item pipelines:
['sinatop.pipelines.MongodbPipeline', 'sinatop.pipelines.SendCloudMsg']
2022-08-17 12:00:20 [scrapy.core.engine] INFO: Spider opened
2022-08-17 12:00:20 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2022-08-17 12:00:20 [scrapy.extensions.telnet] INFO: Telnet console listening on 127.0.0.1:6024
2022-08-17 12:00:20 [root] WARNING: url------>>>>>>
2022-08-17 12:00:20 [root] WARNING: {'_id': ObjectId('62f9b984ea6616a6e12df970'), 'url': 'https://newsapi.sina.cn/?resource=search/hotwords&appVersion=7.88.0&chwm=3023_0001&city=CN52010000000000&connectionType=2&deviceId=c41c85eaa5b84d3044f624efbee15dca02aaab08&deviceInfo=iPhone13%2C4___D54pAP&deviceModel=apple-iphone12Pro-max&from=6000093012&idfa=00000000-0000-0000-0000-000000000000&idfv=DFBD8781-A2E6-499A-9147-5FE2481BC6DA&ids=%7B%22ip%22%3A%2258.42.241.150%22%2C%22caid%22%3A%2220220111_01f5a6fcdf35fef69cadbc6f57b01d23%2C20211207_15a94f5b0bdff4fbd5dbc70ce1f59273%22%7D&imei=c41c85eaa5b84d3044f624efbee15dca02aaab08&ipv4=58.42.241.150&location=26.564437%2C106.718162&loginType=1&osVersion=15.6&resolution=1284x2778&sand=&seId=67b9b23177&seid_v2=6437421243&ssoVer=3&ua=apple-iphone12Pro-max__sinanews__7.88.0__iOS__15.6__202208092049.1&udid=c41c85eaa5b84d3044f624efbee15dca02aaab08&unicomFree=0&userMode=0&webview_ua=Mozilla%2F5.0%20%28iPhone%3B%20CPU%20iPhone%20OS%2015_6%20like%20Mac%20OS%20X%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Mobile%2F15E148&weiboUid=1134499407&weiboVisitId=2007346454712&wxOpenSDKVer=1.8.7.1&channel=news_hotlist&pageType=searchFront', 'headers': {'Host': 'newsapi.sina.cn', 'Accept': 'application/json', 'SN-REQID': '1660533124143de091da13958', 'rand': '617', 'sessionTimes': '45', 'urlSign': '8d317278cb', 'signVer': '2.0', 'Accept-Encoding': 'gzip, deflate, br', 'Accept-Language': 'zh-Hans-CN;q=1', 'gsid': '_2A6ynlZuW-xhzv3E72us2zbadK7owuQc_6mnxc2Gnnpo8qZqrVNnT76FyKbbTeqjB6esdKJSDKJkGx7fupbMD9sZl', 'User-Agent': 'apple-iphone12Pro-max__sinanews__7.88.0__iOS__15.6__202208092049.1', 'Referer': 'http://newsapp.sina.cn', 'Connection': 'keep-alive', 'Cookie': 'SUB=_2A25P9z-zDeRhGedP6FYV-SfIyzuIHXVta2v7rDV9PUJbitCOLVTHkWtNXCzTk3HBib10cnbH53ChLwp9tkB-3O9X; SUBP=0033WrSXqPxfM725Ws9jqgMF55529P9D9W59vhsuB7FMk07ZnDs7cqkU5NHD95QpeKeXSh.4Sh5NWs4DqcjeCsL_qgpywg899PxD; vt=4; genTime=1657518858; ustat=__180.124.177.249_1657518858_0.83239200'}, 'type': 'top', 'status': 1, 'add_time': 1660533124}
2022-08-17 12:00:20 [scrapy.core.engine] DEBUG: Crawled (200) <GET https://newsapi.sina.cn/?resource=search/hotwords&appVersion=7.88.0&chwm=3023_0001&city=CN52010000000000&connectionType=2&deviceId=c41c85eaa5b84d3044f624efbee15dca02aaab08&deviceInfo=iPhone13%2C4___D54pAP&deviceModel=apple-iphone12Pro-max&from=6000093012&idfa=00000000-0000-0000-0000-000000000000&idfv=DFBD8781-A2E6-499A-9147-5FE2481BC6DA&ids=%7B%22ip%22%3A%2258.42.241.150%22%2C%22caid%22%3A%2220220111_01f5a6fcdf35fef69cadbc6f57b01d23%2C20211207_15a94f5b0bdff4fbd5dbc70ce1f59273%22%7D&imei=c41c85eaa5b84d3044f624efbee15dca02aaab08&ipv4=58.42.241.150&location=26.564437%2C106.718162&loginType=1&osVersion=15.6&resolution=1284x2778&sand=&seId=67b9b23177&seid_v2=6437421243&ssoVer=3&ua=apple-iphone12Pro-max__sinanews__7.88.0__iOS__15.6__202208092049.1&udid=c41c85eaa5b84d3044f624efbee15dca02aaab08&unicomFree=0&userMode=0&webview_ua=Mozilla%2F5.0%20%28iPhone%3B%20CPU%20iPhone%20OS%2015_6%20like%20Mac%20OS%20X%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Mobile%2F15E148&weiboUid=1134499407&weiboVisitId=2007346454712&wxOpenSDKVer=1.8.7.1&channel=news_hotlist&pageType=searchFront> (referer: http://newsapp.sina.cn)
2022-08-17 12:00:20 [scrapy.core.scraper] DEBUG: Scraped from <200 https://newsapi.sina.cn/?resource=search/hotwords&appVersion=7.88.0&chwm=3023_0001&city=CN52010000000000&connectionType=2&deviceId=c41c85eaa5b84d3044f624efbee15dca02aaab08&deviceInfo=iPhone13%2C4___D54pAP&deviceModel=apple-iphone12Pro-max&from=6000093012&idfa=00000000-0000-0000-0000-000000000000&idfv=DFBD8781-A2E6-499A-9147-5FE2481BC6DA&ids=%7B%22ip%22%3A%2258.42.241.150%22%2C%22caid%22%3A%2220220111_01f5a6fcdf35fef69cadbc6f57b01d23%2C20211207_15a94f5b0bdff4fbd5dbc70ce1f59273%22%7D&imei=c41c85eaa5b84d3044f624efbee15dca02aaab08&ipv4=58.42.241.150&location=26.564437%2C106.718162&loginType=1&osVersion=15.6&resolution=1284x2778&sand=&seId=67b9b23177&seid_v2=6437421243&ssoVer=3&ua=apple-iphone12Pro-max__sinanews__7.88.0__iOS__15.6__202208092049.1&udid=c41c85eaa5b84d3044f624efbee15dca02aaab08&unicomFree=0&userMode=0&webview_ua=Mozilla%2F5.0%20%28iPhone%3B%20CPU%20iPhone%20OS%2015_6%20like%20Mac%20OS%20X%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Mobile%2F15E148&weiboUid=1134499407&weiboVisitId=2007346454712&wxOpenSDKVer=1.8.7.1&channel=news_hotlist&pageType=searchFront>
{'add_time': 1660708820,
 'hotValue': 4100000,
 'status': 1,
 'title': '东部4省要完成中央财政上缴任务',
 'update_time': 1660708820,
 'url': 'https://sinanews.sina.cn/native_zt/yingyanlandingpage1660704490'}
2022-08-17 12:00:21 [scrapy.core.scraper] DEBUG: Scraped from <200 https://newsapi.sina.cn/?resource=search/hotwords&appVersion=7.88.0&chwm=3023_0001&city=CN52010000000000&connectionType=2&deviceId=c41c85eaa5b84d3044f624efbee15dca02aaab08&deviceInfo=iPhone13%2C4___D54pAP&deviceModel=apple-iphone12Pro-max&from=6000093012&idfa=00000000-0000-0000-0000-000000000000&idfv=DFBD8781-A2E6-499A-9147-5FE2481BC6DA&ids=%7B%22ip%22%3A%2258.42.241.150%22%2C%22caid%22%3A%2220220111_01f5a6fcdf35fef69cadbc6f57b01d23%2C20211207_15a94f5b0bdff4fbd5dbc70ce1f59273%22%7D&imei=c41c85eaa5b84d3044f624efbee15dca02aaab08&ipv4=58.42.241.150&location=26.564437%2C106.718162&loginType=1&osVersion=15.6&resolution=1284x2778&sand=&seId=67b9b23177&seid_v2=6437421243&ssoVer=3&ua=apple-iphone12Pro-max__sinanews__7.88.0__iOS__15.6__202208092049.1&udid=c41c85eaa5b84d3044f624efbee15dca02aaab08&unicomFree=0&userMode=0&webview_ua=Mozilla%2F5.0%20%28iPhone%3B%20CPU%20iPhone%20OS%2015_6%20like%20Mac%20OS%20X%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Mobile%2F15E148&weiboUid=1134499407&weiboVisitId=2007346454712&wxOpenSDKVer=1.8.7.1&channel=news_hotlist&pageType=searchFront>
{'add_time': 1660708821,
 'hotValue': 4080000,
 'status': 1,
 'title': '孩子高铁上吵闹不止乘客提醒被家长怼',
 'update_time': 1660708821,
 'url': 'https://sinanews.sina.cn/native_zt/yingyanlandingpage1660696008'}
2022-08-17 12:00:21 [scrapy.core.scraper] DEBUG: Scraped from <200 https://newsapi.sina.cn/?resource=search/hotwords&appVersion=7.88.0&chwm=3023_0001&city=CN52010000000000&connectionType=2&deviceId=c41c85eaa5b84d3044f624efbee15dca02aaab08&deviceInfo=iPhone13%2C4___D54pAP&deviceModel=apple-iphone12Pro-max&from=6000093012&idfa=00000000-0000-0000-0000-000000000000&idfv=DFBD8781-A2E6-499A-9147-5FE2481BC6DA&ids=%7B%22ip%22%3A%2258.42.241.150%22%2C%22caid%22%3A%2220220111_01f5a6fcdf35fef69cadbc6f57b01d23%2C20211207_15a94f5b0bdff4fbd5dbc70ce1f59273%22%7D&imei=c41c85eaa5b84d3044f624efbee15dca02aaab08&ipv4=58.42.241.150&location=26.564437%2C106.718162&loginType=1&osVersion=15.6&resolution=1284x2778&sand=&seId=67b9b23177&seid_v2=6437421243&ssoVer=3&ua=apple-iphone12Pro-max__sinanews__7.88.0__iOS__15.6__202208092049.1&udid=c41c85eaa5b84d3044f624efbee15dca02aaab08&unicomFree=0&userMode=0&webview_ua=Mozilla%2F5.0%20%28iPhone%3B%20CPU%20iPhone%20OS%2015_6%20like%20Mac%20OS%20X%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Mobile%2F15E148&weiboUid=1134499407&weiboVisitId=2007346454712&wxOpenSDKVer=1.8.7.1&channel=news_hotlist&pageType=searchFront>
{'add_time': 1660708821,
 'hotValue': 3750000,
 'status': 1,
 'title': '劳荣枝案家属回应',
 'update_time': 1660708821,
 'url': 'https://sinanews.sina.cn/native_zt/yingyanlandingpage1660700985'}
2022-08-17 12:00:21 [scrapy.core.scraper] DEBUG: Scraped from <200 https://newsapi.sina.cn/?resource=search/hotwords&appVersion=7.88.0&chwm=3023_0001&city=CN52010000000000&connectionType=2&deviceId=c41c85eaa5b84d3044f624efbee15dca02aaab08&deviceInfo=iPhone13%2C4___D54pAP&deviceModel=apple-iphone12Pro-max&from=6000093012&idfa=00000000-0000-0000-0000-000000000000&idfv=DFBD8781-A2E6-499A-9147-5FE2481BC6DA&ids=%7B%22ip%22%3A%2258.42.241.150%22%2C%22caid%22%3A%2220220111_01f5a6fcdf35fef69cadbc6f57b01d23%2C20211207_15a94f5b0bdff4fbd5dbc70ce1f59273%22%7D&imei=c41c85eaa5b84d3044f624efbee15dca02aaab08&ipv4=58.42.241.150&location=26.564437%2C106.718162&loginType=1&osVersion=15.6&resolution=1284x2778&sand=&seId=67b9b23177&seid_v2=6437421243&ssoVer=3&ua=apple-iphone12Pro-max__sinanews__7.88.0__iOS__15.6__202208092049.1&udid=c41c85eaa5b84d3044f624efbee15dca02aaab08&unicomFree=0&userMode=0&webview_ua=Mozilla%2F5.0%20%28iPhone%3B%20CPU%20iPhone%20OS%2015_6%20like%20Mac%20OS%20X%29%20AppleWebKit%2F605.1.15%20%28KHTML%2C%20like%20Gecko%29%20Mobile%2F15E148&weiboUid=1134499407&weiboVisitId=2007346454712&wxOpenSDKVer=1.8.7.1&channel=news_hotlist&pageType=searchFront>
{'add_time': 1660708821,
 'hotValue': 3680000,
 'status': 1,
 'title': '92岁义乌老人捐款100万抗疫',
 'update_time': 1660708821,
 'url': 'https://so.sina.cn/search/list.d.html?keyword=92%E5%B2%81%E4%B9%89%E4%B9%8C%E8%80%81%E4%BA%BA%E6%8D%90%E6%AC%BE100%E4%B8%87%E6%8A%97%E7%96%AB'}
2022-08-17 12:00:21 [scrapy.core.scraper] ERROR: Error processing {'add_time': 1660708821,
 'hotValue': 3250000,
 'status': 1,
 'title': '多部门鼓励毕业生到基层建功立业',
 'update_time': 1660708821,
 'url': 'https://sinanews.sina.cn/native_zt/yingyanlandingpage1660703683'}
Traceback (most recent call last):
  File "/root/archiconda3/envs/spider/lib/python3.8/site-packages/twisted/internet/defer.py", line 858, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "/root/archiconda3/envs/spider/lib/python3.8/site-packages/scrapy/utils/defer.py", line 150, in f
    return deferred_from_coro(coro_f(*coro_args, **coro_kwargs))
  File "/tmp/sinatop-1660636923-r53aeiu0.egg/sinatop/pipelines.py", line 48, in process_item
    col.replace_one({"title": item['title']}, sinatop)
  File "/root/archiconda3/envs/spider/lib/python3.8/site-packages/pymongo/collection.py", line 752, in replace_one
    self._update_retryable(
  File "/root/archiconda3/envs/spider/lib/python3.8/site-packages/pymongo/collection.py", line 677, in _update_retryable
    return self.__database.client._retryable_write(
  File "/root/archiconda3/envs/spider/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1340, in _retryable_write
    return self._retry_with_session(retryable, func, s, None)
  File "/root/archiconda3/envs/spider/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1229, in _retry_with_session
    return self._retry_internal(retryable, func, session, bulk)
  File "/root/archiconda3/envs/spider/lib/python3.8/site-packages/pymongo/mongo_client.py", line 1261, in _retry_internal
    return func(session, sock_info, retryable)
  File "/root/archiconda3/envs/spider/lib/python3.8/site-packages/pymongo/collection.py", line 669, in _update
    return self._update(
  File "/root/archiconda3/envs/spider/lib/python3.8/site-packages/pymongo/collection.py", line 646, in _update
    _check_write_command_response(result)
  File "/root/archiconda3/envs/spider/lib/python3.8/site-packages/pymongo/helpers.py", line 209, in _check_write_command_response
    _raise_last_write_error(write_errors)
  File "/root/archiconda3/envs/spider/lib/python3.8/site-packages/pymongo/helpers.py", line 179, in _raise_last_write_error
    raise WriteError(error.get("errmsg"), error.get("code"), error)
pymongo.errors.WriteError: After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('62fc60cdad4b4e8d1c4ab4d6'), full error: {'index': 0, 'code': 66, 'errmsg': "After applying the update, the (immutable) field '_id' was found to have been altered to _id: ObjectId('62fc60cdad4b4e8d1c4ab4d6')"}
2022-08-17 12:00:21 [scrapy.core.engine] INFO: Closing spider (finished)
2022-08-17 12:00:21 [scrapy.statscollectors] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 1569,
 'downloader/request_count': 1,
 'downloader/request_method_count/GET': 1,
 'downloader/response_bytes': 1883,
 'downloader/response_count': 1,
 'downloader/response_status_count/200': 1,
 'elapsed_time_seconds': 0.860196,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2022, 8, 17, 4, 0, 21, 181178),
 'httpcompression/response_bytes': 4011,
 'httpcompression/response_count': 1,
 'item_scraped_count': 4,
 'log_count/DEBUG': 5,
 'log_count/ERROR': 1,
 'log_count/INFO': 10,
 'log_count/WARNING': 3,
 'memusage/max': 68337664,
 'memusage/startup': 68337664,
 'response_received_count': 1,
 'scheduler/dequeued': 1,
 'scheduler/dequeued/memory': 1,
 'scheduler/enqueued': 1,
 'scheduler/enqueued/memory': 1,
 'start_time': datetime.datetime(2022, 8, 17, 4, 0, 20, 320982)}
2022-08-17 12:00:21 [scrapy.core.engine] INFO: Spider closed (finished)
